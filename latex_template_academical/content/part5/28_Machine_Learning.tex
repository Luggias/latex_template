\chapter{Machine Learning in Trading}\label{ch:ml}

\begin{abstract}
We cover feature engineering, model validation, and deployment patterns
for both batch and online learning, emphasising open‑source libraries
(`scikit‑learn`, `PyTorch`, `xgboost`).
\end{abstract}

\section{Feature Pipeline}

\begin{itemize}
  \item Price‐derived: returns, volatility, order‑imbalance.
  \item Alternative: news sentiment, satellite, on‑chain metrics.
\end{itemize}

Use `sklearn.compose.ColumnTransformer` to prevent look‑ahead leakage.

\section{Cross‑Validation Scheme}

Purged walk‑forward CV (De Prado) removes overlapping label leakage.

\subsection*{Example}

\begin{minted}{python}
from sklearn.model_selection import TimeSeriesSplit
tscv = TimeSeriesSplit(gap=5, n_splits=5, test_size=20)
\end{minted}

\section{Online Learning}

Hedge incremental drift with `river`, adaptive hyper‑params.

\section{Model Governance}

* Feature store versioning (Feast).  
* Explainability (SHAP) for compliance.

\section*{Key Takeaways}
\begin{itemize}
  \item Data leakage is enemy #1—temporal CV is mandatory.
  \item Deployment ≠ model accuracy; latency, monitoring, rollback matter.
\end{itemize}
