% ===========================
%      mystyle.sty
%      Corporate LaTeX Layer
% ===========================

% --- FONT & ENCODING ---
\RequirePackage[T1]{fontenc} % Use T1 font encoding for better hyphenation and support for special characters (e.g., accents, umlauts)
\RequirePackage{lmodern}     % Use Latin Modern fonts — improves output quality and supports T1 encoding for better hyphenation and PDF rendering
\RequirePackage{fix-cm}      % Enables scalable Computer Modern fonts
% --- COLOR & GRAPHICS ---
\RequirePackage{xcolor}      % Adds support for color definitions
\RequirePackage{graphicx}    % Allows image inclusion with \includegraphics{}
% --- LAYOUT & GEOMETRY ---
\RequirePackage{geometry}    % Customize page margings and layout
\geometry{                   % Page margings for scientific purposes
   top=2.5cm,
   bottom=2cm,               % Use 3cm - 4cm for scientific papers to leave room for binding
   left=2cm,
   right=2cm}
%\geometry{    % Page margings for business letters
%   top=4.5cm,
%   bottom=2cm,
%   left=2cm,
%   right=2cm}
% --- LANGUAGE & QUOTES ---
\RequirePackage[ngerman, english]{babel} % Supports German and English text
\RequirePackage{csquotes}    % Provides context-aware quotation commands like \enquote{}, supporting language-specific quotation styles
% --- TABLES & TOC ---
\RequirePackage{booktabs}    % Enhances table quality by providing professional-looking horizontal rules (e.g., \toprule, \midrule, \bottomrule)
\RequirePackage{tocloft}     % Custom TOC formatting
% --- MATHEMATICS ---
\RequirePackage{amsfonts}    % Provides additional maths fonts
\RequirePackage{amsmath}     % Enhances mathematical typesetting
\RequirePackage{amssymb}     % Additional math symbols
\RequirePackage{amsthm}      % Theorem environments
\RequirePackage{mathtools}   % Extra math tools
% --- ENUMERATE / ITEMIZE STYLE ---
\RequirePackage{enumitem}    % Customize llist formatting (e.g.y itemize, enumerate)
\setlist[itemize]{topsep=3.5pt, partopsep=3.5pt, noitemsep}   % Reduces vertical spacing around itemize lists:
                                                              % - topsep: space before and after the entire list
                                                              % - partopsep: additional space when the list starts a new paragraph
                                                              % - noitemsep: removes space between individual list items
\setlist[enumerate]{topsep=3.5pt, partopsep=3.5pt, noitemsep} % Same as above, but for enumerate lists (numbered)
% --- HEADER/FOOTER ---
\RequirePackage{fancyhdr} % Customize headers and footers
% --- HYPERLINKS & PDF METADATA ---
\RequirePackage{hyperref}    % Adds clickable hyperlinks and table of contents links
\hypersetup{                 % Adjust and add comment
  colorlinks=true,           % Färbt Links statt sie zu umrahmen
  linkcolor=black,           % Inhaltsverzeichnis, interne Links
  citecolor=black,           % Literaturverweise
  filecolor=black,           % Verweise auf lokale Dateien
  urlcolor=black,            % Externe URLs/Mailadressen
  pdfauthor={Lukas Maximilian Kapferer}, % Project specific
  pdftitle={LaTeX Template}, % Project specific
  pdfsubject={},
  pdfkeywords={},
  pdfcreator={LaTeX (latexmk, VS Code, mystyle.sty v1.1)},
  bookmarksnumbered=true,    % Nummerierung in den Bookmarks
  bookmarksopen=true,        % Inhaltsverzeichnis geöffnet
  pdfstartview=FitH,         % Erste Seite „Fit width“
  breaklinks=true,           % Links umbrechbar
}
\RequirePackage{bookmark}    % Check for relevance, doubles, define order and then add descriptive comment
% --- CODE ENVIRONMENTS ---
\RequirePackage{minted}      % Check for relevance, doubles, define order and then add descriptive comment
\usemintedstyle{github-dark}      % Check for relevance, doubles, define order and then add descriptive comment
% --- BOXES & CUSTOM ENVIRONMENTS ---
\RequirePackage[most]{tcolorbox}  % Colored and framed boxes
% --- TITLE & TITLEPAGE ---
\RequirePackage{titling}     %  Customize the title page and title formatting
% --- PATCHING COMMANDS ---
\RequirePackage{listings}    % Enables source code display with syntax highlighting
\setlength{\parindent}{0pt}  % Disables paragraph indentation
% --- SCIENTIFIC UNITS (siunitx) ---
\RequirePackage{siunitx}      % Consistent typesetting of units and numbers
\sisetup{
  detect-all,                 % Detect surrounding font style
  group-separator = {\,},     % Thin space as thousand separator
  group-minimum-digits = 4,   % Start grouping at 4 digits
  per-mode=symbol,            % Use '/' for units
  output-decimal-marker = {.} % Always use '.' for decimals
  locale=EN                   % English formatting
}
% --- BIBLIOGRAPHY MANAGEMENT ---
\RequirePackage[backend=biber,style=apa,sorting=nyt]{biblatex} % Unified citation and bibliography style
% --- SMART REFERENCES (cleveref) ---
\RequirePackage[capitalise]{cleveref} % Automatic, intelligent cross-references
% Now \cref{eq:foo} outputs "Equation (1)" automatically.
% Option: add 'nameinlink' for hyperlinking the entire label

% ---------------------------------------------------------------
% -------------------- Style setup for boxes --------------------
% ---------------------------------------------------------------
\tcbset{
  commonbox/.style={
    enhanced,
    boxrule=1pt,
    arc=4pt,
    fonttitle=\bfseries
  },
  bluebox/.style={
    commonbox,
    colback=blue!5,
    colframe=blue!60!black
  },
  yellowbox/.style={
    commonbox,
    colback=yellow!20,
    colframe=orange!80!black
  }
}

\newtcbtheorem[auto counter, number within=section]{example}{Example}{
  colback=blue!5!white, colframe=blue!75!black,
  fonttitle=\bfseries,
  colbacktitle=blue!15!white,
  coltitle=black,
  attach boxed title to top left={yshift=-2mm,xshift=6mm},
  boxed title style={boxrule=0.7pt,rounded corners,south west, south east},
  breakable, before skip=10pt, after skip=10pt,
}{ex}

\newtcbtheorem[auto counter, number within=section]{definition}{Definition}{
  colback=yellow!10!white, colframe=orange!80!black,
  fonttitle=\bfseries,
  colbacktitle=yellow!20!white,
  coltitle=black,
  attach boxed title to top left={yshift=-2mm,xshift=6mm},
  boxed title style={boxrule=0.7pt,rounded corners,south west, south east},
  breakable, before skip=10pt, after skip=10pt,
}{def}


% ---------------------------------------------------------------
% ----------- 4th-level heading - \subsubsubsection{} -----------
% ---------------------------------------------------------------

% Define a new counter for the 4th-level heading (subsubsubsection)
\newcounter{subsubsubsection}[subsubsection]

% Set the numbering format to 1.1.1.1
\renewcommand\thesubsubsubsection{\thesubsubsection.\arabic{subsubsubsection}}

% Define the new command \subsubsubsection with TOC entry and formatting
\newcommand\subsubsubsection[1]{
  \par\refstepcounter{subsubsubsection}                                                % increase counter and make it referencable
  \addcontentsline{toc}{subsubsubsection}{\protect\numberline{\thesubsubsubsection}#1} % add to table of contents
  \textbf{\thesubsubsubsection\quad #1}\par\nobreak\vspace{0.5\baselineskip}           % bold heading + spacing
}

% Enable 4th-level headings in the table of contents
\setcounter{tocdepth}{4}

% Optional: Define appearance of the 4th-level heading in the TOC
\addtocontents{toc}{\protect\setcounter{tocdepth}{4}}
\makeatletter
\newcommand{\l@subsubsubsection}{\@dottedtocline{4}{7em}{4em}} % indentation and formatting in TOC
\makeatother
\newcommand*{\code}{\lstinline[basicstyle=\color{codeblue}\ttfamily, breaklines=true]}

% ---------------------------------------------------------------
% ---------- Section redefinition to force page break -----------
% ---------------------------------------------------------------

\RequirePackage{etoolbox}
\pretocmd{\section}{\clearpage}{}{}

% ---------------------------------------------------------------
% --------- Source Code Environment for Java and Python ---------
% ---------------------------------------------------------------

% 1. Color Scheme Definition (feel free to customize)
% ----------------------------------------------------
\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.97,0.97,0.97}
\definecolor{codeblue}{rgb}{0.1,0.1,0.7}    % Keywords
\definecolor{codeteal}{rgb}{0.1,0.5,0.5}    % Types
\definecolor{codeorange}{rgb}{0.8,0.3,0}  % Annotations & special keywords


% 2. General Style for Code Listings ("IDE Style")
% ----------------------------------------------------
\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{codegreen}\itshape, % Italic comments
    % Definition of multiple keyword styles
    keywordstyle=[1]\color{codeblue}\bfseries, % Style for main keywords
    keywordstyle=[2]\color{codeteal},          % Style for types and classes
    keywordstyle=[3]\color{codeorange},        % Style for annotations
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=2,
    frame=single,
    framerule=0.5pt,
    rulecolor=\color{black!30}
}

% 3. Create dedicated environments for Java and Python
%    This applies the general style and adds language-specific keywords.
% -------------------------------------------------------------------------
% JAVA Environment
\lstnewenvironment{java}[1][]{
    \lstset{
        language=Java,
        style=mystyle,
        % Keyword group 1: Core language keywords (blue, bold)
        morekeywords=[1]{public, private, protected, class, void, if, else, for, while, return, new, this, static, final, extends, implements, try, catch, finally, throws, throw},
        % Keyword group 2: Types and important classes (teal)
        morekeywords=[2]{String, double, int, boolean, char, long, float, short, byte, Object, System, Integer, Double, Boolean, List, ArrayList, Map, HashMap, Exception},
        % Keyword group 3: Annotations (orange)
        morekeywords=[3]{@Override, @SuppressWarnings, @Deprecated},
        #1 % Allows for additional parameters like caption
    }
}{}

% PYTHON Environment
\lstnewenvironment{python}[1][]{
    \lstset{
        language=Python,
        style=mystyle,
        % Keyword group 1: Core language keywords (blue, bold)
        morekeywords=[1]{def, class, if, elif, else, for, while, return, import, from, as, with, try, except, finally, raise, pass, lambda, in, is, not, and, or, True, False, None},
        % Keyword group 2: Built-in functions and common types (teal)
        morekeywords=[2]{self, print, len, range, enumerate, str, int, float, list, dict, set, tuple, super},
        % Keyword group 3: Decorators (orange)
        morekeywords=[3]{@staticmethod, @classmethod, @property},
          literate={\{}{{\char`\{}}1 {\}}{{\char`\}}}1,
        #1
    }
}{}

% ---------------------------------------------------------------
%              --------- Header and Footer ---------
% ---------------------------------------------------------------

\pagestyle{fancy}   % Required for header and footer
\fancyfoot[C]{}     % Removes automatically generated cenetered page numbering
\lhead{\thetitle}   % Set left-header to the document title
\lfoot{\theauthor}  % Set left-footer to the author name
\rfoot{\thepage}    % Insert page number to the right-footer
\renewcommand{\footrulewidth}{0.4pt}  % Set footer line (has same width as header)

% ===========================
%      END mystyle.sty
% ===========================